# ConvUNeXt: An efficient convolution neural network for medical image segmentation

## 저널 : Knowledge-Based Systems (2022), Q1, 12.8%

## 저자 : ![Alt text](image.png)

## Abstract :
- 최근 ConvNexTs 경쟁력있는 다양한 이미지 성능을 생산하기 위해 표준 ConvNet (CNN 기반 모델)로부터 만들었다.
- 이 논문은 classic UNet 기반 효율적인 모델이다. 
  - 낮은 parameters을 가지고 큰 성과를 만들었다.(medical image segmentation에서)
  - ConvNeXt에서 영감을 받아 설계된 모델은 ConvUNeXt라고 불리며 뛰어난 segmentation 우위(superiority)를 유지하면서 매개 변수의 양을 줄이는 방향으로 사용됩니다
  - 특히 **먼저 큰 컨볼루션 커널과 깊이별 분리 가능한 컨볼루션을 사용하여 매개 변수 수를 크게 감소시켜 UNet의 컨볼루션 블록을 개선한 다음 인코더와 디코더 모두의 residual 연결을 추가하고 다운 샘플링을 위한 컨볼루션을 채택하여 pooling을 포기**합니다. 
    - skip connection 중에는 낮은 수준의 의미 정보에서 노이즈를 걸러내고 관련 없는 기능을 억제하도록 경량 주의 메커니즘이 설계되어 네트워크가 대상 영역에 더 많은 attention를 기울일 수 있습니다.
  - 표준 UNet과 비교하여 우리 모델은 매개 변수가 20% 적으며, 다른 데이터 세트에 대한 실험 결과는 데이터 양이 부족하거나 충분할 때 우수한 분할 성능을 보이는 것으로 나타났습니다. 
  - 코드는 https://github.com/1914669687/ConvUNeXt 에서 확인할 수 있습니다.

**Keywords**
Convolution neural network, Deep learning, Medical image processing, Semantic segmentation

## 1. Introduction:

- 딥 러닝에 대한 추가 조사와 함께 의미론적 분할 기술은 큰 발전을 이루었다. 의미론적 분할은 초기 이미지를 특정 의미를 가진 개별 영역으로 분리하는 방법을 의미하며, 이에 따라 각 영역 블록의 의미론적 범주는 픽셀당 주석으로 식별됩니다.
  -  현재, 컨볼루션 신경망을 기반으로 한 의미론적 분할 방법은 FCN [25], SegNet [26], PSPNet [27], DeepLab [28], [29], [30], [31] 등과 같이 연속적으로 개발되어 왔습니다. 
  -  그러나 의료 영상은 일반적으로 작은 대상으로 복잡한 구조를 가지고 있기 때문에 실질적으로 개별 개체의 경계가 모호하고 정상 조직과 중첩되기 때문에 의료 영상의 자동 의미론적 분할은 여전히 매우 어렵습니다. 
- 반면, 건너뛰기 연결이 있는 UNet [33] 코덱 구조는 다른 수준의 기능을 융합할 수 있으므로 의료 영상 분할을 탐구하기 위한 새로운 생각을 제공합니다. 
- 본 논문에서는 의료 영상 분할에 대한 개선된 절차로 훈련된 표준 UNet에 초점을 맞추어 기존 UNet에 비해 매개 변수 수를 크게 줄여 더 나은 분할 성능을 달성합니다.
  
- 논문의 리마인드는 다음과 같이 정리되어 있습니다. 
  - 2절에서는 먼저 관련 작업의 현재 진행 상황을 설명합니다. 
  - 3절에서는 UNet을 ConvUNeXt로 변환하는 방법을 단계별로 설명합니다. 
  - 그리고 실험 결과는 4절에 제시되어 있습니다. 
  - 마지막으로 5절에서는 본 논문에 대한 결론과 논의를 도출합니다(그림 1 참조).


![Alt text](image-1.png)

## 2. Related work

- UNet은 높은 효율성으로 인해 의료 이미지 분할 영역에서 주류 아키텍처가 되었습니다. 
  - 분할의 성능을 더욱 향상시키기 위해 연구자들은 UNet 아키텍처를 탐색하고 많은 개선된 방법을 제시하기 위해 개발했습니다.
  -  이 절에서는 다양한 기술적 관점에서 UNet의 몇 가지 대표 및 다양한 변형을 간략하게 소개할 것입니다.

### 2.1. Enhanced feature fusion

- **의료 영상 구조의 복잡한 특수성으로 인해, 낮은 수준과 높은 수준의 시맨틱 정보는 모두 상호 보완적이고 매우 중요**합니다 [34], [35].
  -  따라서, UNet은 상향 샘플링을 수행할 때 낮은 수준의 시맨틱 정보와 통합하기 위해 생략 연결을 채택하지만, 낮은 수준의 시맨틱 정보를 직접 연결하는 최적의 방법은 아닙니다. 
  -  따라서, 특징 융합(feature fusion.)을 향상시키기 위해 많은 방법이 제안됩니다. 
  -  특히, 주의 UNet [36]은 인코더의 각 해상도의 특징을 디코더의 해당 특징과 연결하기 전에 인코더의 출력 특징을 변경할 목적으로 UNet에 주의 모듈을 결합하여 도입되었습니다. 
  -  모듈은 게이트 신호(gated signal)를 생성하여 서로 다른 공간 위치에서 특징의 중요성을 제어하고, 특정 로컬 영역에서도 관련된 특징을 강조하면서 입력 영상의 관련 없는 영역을 억제(suppress)합니다.

## 2.2. Add residual structure

- ResNet 네트워크 구조는 가장 성공적인 딥 러닝 모델 중 하나가 되었고 ResNet 네트워크 구조에 의해 설계된 잔여 구조는 이후의 접근 방식에 의해 널리 채택되었습니다. 
  - 의료 이미지 분할을 다루기 위해 Xiao et al. [37]는 잔여 구조를 UNet에 도입하고 가중 주의 메커니즘이라고 불렀습니다. 
  - 이 메커니즘을 채택함으로써 모델은 관심 대상 영역에 초점을 맞출 뿐만 아니라 관련 없는 잡음 배경도 폐기했습니다.


### 2.3. Improved skip connection

**UNet++ [38]**
- UNet의 직접 연결은 너무 거칠어서 연결된 두 컨볼루션 계층의 입력 간에 의미적 차이가 크고 네트워크 학습의 어려움도 증가할 것입니다.
  -  따라서 의미적 차이를 완화하기 위해 UNet의 직접 연결을 기반으로 UNet++는 조밀 구조와 유사한 컨볼루션 계층을 추가했습니다. 
  -  한편, 동일한 조밀 블록의 이전 컨볼루션 계층의 출력은 하위 조밀 블록의 업샘플링 동작과 융합됩니다. 
  -  이를 통해 인코딩된 특징의 의미적 수준이 디코더에 대기 중인 특징 맵의 의미적 수준과 더 유사해집니다.
  -  dense skip connections의 장점은 모든 이전 특징 맵이 누적되어 각 스킵 경로의 조밀 컨볼루션 블록을 통해 현재 노드에 도달함을 보장합니다.


**UNet3+**
- 낮은 수준의 피처 맵은 객체 경계를 강조할 뿐만 아니라 풍부한 공간 정보를 캡처할 수 있습니다. 
  - 이에 상응하여 높은 수준의 의미 피처 맵은 객체의 위치 정보를 반영합니다. 
  - 그러나 이러한 미묘한 신호는 아래로 샘플링하거나 위로 샘플링할 때 점차 손실될 수 있습니다. 
  - 이 문제를 해결하기 위해 UNet3+는 전체 다중 스케일에서 세밀한 세부 사항과 거친 수준의 의미를 캡처하기 위해 서로 다른 스케일의 피처 그래프에서 높은 수준과 낮은 수준의 의미를 직접 결합하는 전면적인 스킵 연결을 설계했습니다.

### 2.4. Combined with traditional methods

- 의료 강도가 불균일하고 배경과 대상 사이의 큰 유사성으로 인해 의료 영상 분할은 여전히 큰 도전 과제입니다. 
- Shu et al. [40]은 레벨 설정 방법과 분할 브레그만 방법의 조합을 공동으로 기반으로 하는 활성 윤곽 모델을 제안했습니다. 
  - 이 모델은 다른 심장 조직 효과 및 이미지 강도 불균일성에 대한 강력한 견고성을 가질 뿐만 아니라 효과적인 조직을 추출하는 데 도움이 되어 최종 결과를 빠르고 정확하게 얻을 수 있습니다. 
  - 특히 간 분할 작업에서 간 CT 영상에서 종양 위치가 명확하지 않고 주변의 이미지 강도(intensities )가 간과 유사하여 원활한 경계를 가진 간 CT 영상을 정확하게 분할하기가 매우 어렵습니다. 
  - Shu et al. [41]은 level set framework를 기반으로 간 CT 영상 모델을 설계하기 위해 전통적인 방법을 딥 러닝 모델과 결합했으며, 분할의 효율성과 정확성을 향상시키기 위한 목적으로 UNet을 적용하여 정보를 제약했습니다.

## 2.5. Other variants

**UNeXt [42].**
- 이는 (1) 컨볼루션 단계와 (2) 토큰화 MLP 단계의 두 단계로 구분할 수 있는 UNet의 설계 철학을 따릅니다. 
  - 입력 영상은 먼저 세 개의 표준 컨볼루션 블록을 통과한 다음 두 개의 토큰화 MLP 계층을 통과하며 인코더와 디코더는 대칭입니다. 
  - 토큰화 MLP는 참조를 위해 Swin 트랜스포머를 사용하여 표준 MLP를 개선한 것입니다. 
    - 첫째, 특징 맵의 특정 채널의 축을 이동하고, 둘째, 완전히 연결된 계층을 통해 고차원 공간으로 매핑한 다음 깊이별로 분리 가능한 컨볼루션을 수행하고, 
    - 마지막으로 원본 채널과 맵을 완전히 연결된 계층을 통해 고차원 공간에서 다시 원래 공간으로 복원합니다. 
- UNExt는 매개 변수의 수와 계산량을 동시에 크게 줄여 CPU에서 빠른 속도로 실행할 수 있습니다. 
- 그러나 지나치게 경량화된 설계는 일반적으로 특징 표현을 불충분하게 하므로 모델의 정확성에 영향을 미칩니다.

**DoubleUNet**

- 그것은 두 개의 UNet 아키텍처의 통합입니다. 
  - 입력 영상은 수정된 UNet에 입력되어 예측 마스크를 생성하고, 이는 입력 영상 요소를 요소별로 곱한 다음 두 번째 성공한 UNet의 입력 역할을 합니다.
  - 두 번째 UNet의 디코더는 디코딩하는 동안 첫 번째 UNet의 각 단계의 인코더 출력을 결합하고 최종적으로 두 개의 UNet의 출력을 최종 출력으로 연결합니다. 
  - 두 번의 인코딩 및 디코딩은 더 높은 정확도를 달성하기 위해 높은 수준과 낮은 수준의 시맨틱 정보의 융합을 더 잘 촉진할 수 있습니다. 
- 그러나 두 개의 UNet의 적층 구조는 매개 변수 및 계산 양의 두 배 이상을 가져올 것입니다.

- **본 논문의 목적은 순수 심층학습을 적용하여 매개변수의 양과 정밀도의 균형을 맞출 뿐만 아니라 정확성을 잃지 않고 매개변수의 양을 최대한 줄이는 것입니다.**

## 3. Method

# 나의 의견 :
- Convnext라는 논문을 읽을 때, 내가 먼저 이것을 제안하려고 했다.
- 찾아보니 이미 논문이 나왔는데 지금 리뷰하는 논문이다.
- 일단 내가 Convnext라는 논문을 읽기전 모델을 만들고 있었는데, 논문을 읽고 나서 시간 낭비라 생각했다.
- 그래서 아이디어가 생각나면 비슷한 아이디어가 나왔는지 미리 체크를 해야 겠다. (물론 대학원 세미나에 발표자료를 만들기 위해서 급하게 실험한 경향이 있다.)
- 일단 논문은 contribution은 convnext를 unet으로 어떻게 잘 활용할지 실험한 논문이다.
- 그리고 그 과정중에서 realted work에서 medical segmetation이 어떻게 발전되고 있는지 간단히 서술했다.
- 
- 일단 어떻게 실험했고 어떻게 서술했는지 이런 점에서 배울 수 있는 좋은 논문이다.
- 근데 realted work을 글로 보아서 그런지 머리에 잘 그려 지지 않는다. 따라서 직접 찾아 보는게 떠 빠를것 같다.
- 근데 cvpr이랑 비교했을때 realted work간 연결이 잘 안되어 있다. 왜? 그런 자기 모델을 썼는지 이유가 잘 연결이 안된다.